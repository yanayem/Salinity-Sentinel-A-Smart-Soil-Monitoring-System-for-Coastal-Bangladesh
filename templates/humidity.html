{% load static %}
{% include 'sidebar.html' %}

<div class="main-content" style="padding: 20px;">
  <h1>ðŸ’§ Humidity Dashboard</h1>

  <div class="devices-cards" id="devices-container" style="display:flex; flex-wrap:wrap; gap:20px;"></div>
</div>

<style>
.device-card {
  border:1px solid #ccc;
  border-radius:12px;
  width:220px;
  padding:15px;
  background:#fff;
  box-shadow:0 2px 8px rgba(0,0,0,0.1);
  text-align:center;
  transition: transform 0.2s;
}
.device-card:hover { transform: scale(1.05); }

.device-name { font-weight:bold; font-size:1.1rem; margin-bottom:10px; }
.value { font-size:1.4rem; font-weight:bold; margin:5px 0; }
.status { font-size:0.9rem; font-weight:600; margin:5px 0; padding:3px 6px; border-radius:5px; }
.status.normal { color:#155724; background:#d4edda; }
.status.low { color:#004085; background:#cce5ff; }
.status.high { color:#721c24; background:#f8d7da; }
.timestamp { font-size:0.8rem; color:#555; margin-top:5px; }
</style>

<script>
  // Sample devices
  const devices = [
    {id:1, name:'Sensor A'},
    {id:2, name:'Sensor B'},
    {id:3, name:'Sensor C'}
  ];

  // Sample humidity readings
  let readings = [
    {humidity:62, updated_at:'10:30:25'},
    {humidity:64, updated_at:'10:25:25'},
    {humidity:58, updated_at:'10:20:25'}
  ];

  function getStatus(humidity) {
    if(humidity < 60) return 'low';
    if(humidity > 70) return 'high';
    return 'normal';
  }

  function renderCards() {
    const container = document.getElementById('devices-container');
    container.innerHTML = '';
    devices.forEach((device,i)=>{
      const r = readings[i % readings.length];
      container.innerHTML += `
        <div class="device-card">
          <div class="device-name">${device.name}</div>
          <div class="value">Humidity: ${r.humidity}%</div>
          <div class="status ${getStatus(r.humidity)}">${getStatus(r.humidity).toUpperCase()}</div>
          <div class="timestamp">Updated: ${r.updated_at}</div>
        </div>
      `;
    });
  }

  renderCards();

  // Simulate live updates
  setInterval(()=>{
    readings = readings.map(r=>({
      humidity: r.humidity + Math.floor(Math.random()*5-2),
      updated_at: new Date().toLocaleTimeString()
    }));
    renderCards();
  },5000);
</script>
